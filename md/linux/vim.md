# Vim

很多操作，普通模式下的快捷键和命令行模式都可以做到。  

## Start
`vim`  
`vim ch4ce.txt`

## Pattern
### Normal
Vim打开以后就是Normal模式  
插入模式和命令模式按Esc切换到Normal模式  

#### 游标移动

`h或←`：左  
`l或→`：右  
`j或↓`：下  
`k或↑`：上  

`w`：移动到下一个单词  
`b`：移动到上一个单词  

`0`：数字零，到行头  
`$`：到本行行尾  
`^`：到本行第一个不是blank字符的位置（所谓blank字符就是空格，tab，换行，回车等）  
`g_`：到本行最后一个不是blank字符的位置  


`+`：光标移动到非空格符的下一行  
`-`：光标移动到非空格符的上一行  


`Ctrl + f`：屏幕向下移动一页，相当于 [Page Down]按键 (常用)  
`Ctrl + b`：屏幕向上移动一页，相当于 [Page Up] 按键 (常用)  
`Ctrl + d`：屏幕向下移动半页  
`Ctrl + u`：屏幕向上移动半页  



`H`	光标移动到这个屏幕的最上方那一行的第一个字符  
`M`	光标移动到这个屏幕的中央那一行的第一个字符  
`L`	光标移动到这个屏幕的最下方那一行的第一个字符  
`G`	移动到这个档案的最后一行(常用)  

`n<space>`：n 为数字。光标向右移动这一行的 n 个字符。  
`n<Enter>`：n 为数字。光标向下移动 n 行(常用)  
`nG`	n 为数字。移动到这个档案的第 n 行。例如 20G 则会移动到这个档案的第 20 行(可配合 :set nu)  

`gg`：移动到这个档案的第一行，相当于 1G ！ (常用)  


#### 选中文本
`v` 进入 Visual Mode，然后用 方向键 或 hjkl 选择文本  

#### 删除
**字符**
`x` 在一行字当中，x 为向后删除一个字符 (相当于 [del] 按键)  
`X` 为向前删除一个字符(相当于 [backspace] 亦即是退格键) (常用)  
nx	n 为数字，连续向后删除 n 个字符。举例来说，我要连续删除 10 个字符， 『10x』。  

**行内**
`dw` 剪切一个word  
`d0或d^` 那个是数字的 0 ，删除游标所在处，到该行的最前面一个字符  
`d$` 删除游标所在处，到该行的最后一个字符  

**行**
`dd` 删除游标所在的那一整行，后面的内容向前移动一行填充，并复制删除的内容到缓冲区，相当于剪切  
`ndd` n 为数字。删除光标所在的向下 n 行，后面的内容向前移动一行填充，并复制删除的内容到缓冲区，相当于剪切  

`cc` 清空当前行并进入编辑模式  
`cj` 删除下一行，并清空当前行进入编辑模式  
`ncj` n是数字，删除后n行，并清空当前行进入编辑模式  

**多行**
`d1G` 删除光标所在到第一行的所有数据  
`dG` 删除光标所在到最后一行的所有数据  

#### 复制粘贴操作

##### 前置知识
1、检查 vim 版本是否支持与系统剪贴板的交互操作  
`vim --version | grep clipboard`  

如果出现`-clipboard`则说明系统的vim版本不支持与系统剪贴板的交互操作  
需要采用如下的命令安装新的vim  
`sudo apt install vim-gtk`  
安装完成之后再利用代码检查一次，出现`+clipboard`，那么系统的vim没有问题。  

1、vim内复制粘贴操作是用寄存器进行存储的，`:reg`可以查看当前已经定义的寄存器名和内容，`"`是寄存器定义符，`"`之后的符号是寄存器名，其中`""`是不加寄存器索引时，默认使用的寄存器。`"*`是当前选择缓冲区，`"+`是系统剪贴板。其他的寄存器名可以自己定义，可以是 `0、1、2、……、9、a……`等，更多的可以通过`:help  registers`命令查看  
```
1.无名（unnamed）寄存器：""，缓存最后一次操作内容；  
2.数字（numbered）寄存器："0 ～"9，缓存最近操作内容，复制与删除有别, "0寄存器缓存最近一次复制的内容，"1-"9缓存最近9次删除内容  
3.行内删除（small delete）寄存器："-，缓存行内删除内容；  
4.具名（named）寄存器："a ～ "z或"A - "0Z，指定时可用；  
5.只读（read-only）寄存器：":,".,"%,"#，分别缓存最近命令、最近插入文本、当前文件名、当前交替文件名；  
6.表达式（expression）寄存器："=，只读，用于执行表达式命令；  
7.选择及拖拽（selection and drop）寄存器："*,"+,"~，存取GUI选择文本，可用于与外部应用交互，使用前提为系统剪切板（clipboard）可用；  
8.黑洞（black hole）寄存器："_，不缓存操作内容（干净删除）；  
9.模式寄存器（last search pattern）："/，缓存最近的搜索模式。  
```

2、要将 vim 的内容复制到某个粘贴板，需要先退出编辑模式，选择要复制的内容，然后按`"Ny`（注意带引号）完成复制，其中 N 为粘贴板号（注意是按下 双引号 + 粘贴板号 + y），例如要把内容复制到粘贴板 a，选中内容后按`"ay`就可以了。  
`"`号寄存器是默认粘贴板，直接按`y`就复制到这个粘贴板中了，直接按`p`就粘贴这个粘贴板中的内容。  
`+` 号粘贴板是系统粘贴板，用`"+y`将内容复制到该粘贴板后可以使用`ctrl＋v`将其粘贴到其他文档（如 firefox、gedit）中，同理，要把在其他地方用`ctrl＋c`或右键复制的内容复制到 vim 中，需要在正常模式下按 `"+p`。  

3、要将 vim 某个粘贴板里的内容粘贴进来，需要先退出编辑模式，再在命令模式按`"Np`，其中 N 为粘贴板号，如上所述，命令 `"5p` 会将 5 号粘贴板里的内容粘贴进来，也可以按 `"+p` 将系统全局粘贴板里的内容粘贴进来。  

##### 复制
**行内**
`yw` 复制一个word  
`ynw` 复制n个word  
`y0或y^` 复制光标所在的那个字符到该行行首的所有数据  
`y$` 复制光标所在的那个字符到该行行尾的所有数据  

**行**
`yy` 复制游标所在的那一行(常用)  
`nyy` n 为数字。复制光标所在的向下 n 行，例如 20yy 则是复制 20 行(常用)  


`y1G` 复制游标所在行到第一行的所有数据  
`yG` 复制游标所在行到最后一行的所有数据  


`p` 将已复制的数据在光标下一行贴上  
`P` 将已复制的数据在光标上一行贴上  

`J` 将光标所在行与下一行的数据结合成同一行，空格分割  




#### 查找替换
**查找**
`/word`：向光标之下寻找一个名称为 word 的字符串。(常用)  
`?word`：向光标之上寻找一个字符串名称为 word 的字符串。  

`n`：代表重复前一个搜寻的动作。替换操作中的查找操作也会被重复。  
`N`：与 n 刚好相反，为反向进行前一个搜寻动作。  

**替换**
`:n1,n2s/word1/word2/g`：n1 与 n2 为数字。在第 n1 与 n2 行之间寻找 word1 这个字符串，并将该字符串取代为 word2 ！  
`:1,$s/word1/word2/g`或`:%s/word1/word2/g`：从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！(常用)  
`:1,$s/word1/word2/gc`或`:%s/word1/word2/gc`：从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！且在取代前显示提示字符给用户确认 (confirm) 是否需要取代！(常用)  

#### 重复操作

`.`小数点！意思是重复前一个动作的意思。 如果你想要重复删除、重复贴上等等动作，按下小数点『.』就好了！ (常用)  

数字+指令 = 多次执行指令  

Command模式下重复操作  
输入命令提示符`:` + 上下箭头（<Up/Down>键）  
输入 `:his` 或者 `:history` 查看历史  


#### 撤销操作
`u` 撤销  
在命令行模式下用 `:undo` 或 `:u` 命令可以撤销最近一次操作。  
`Ctrl + r` 反撤销  

### Insert  
普通模式下有以下按键可以进入Insert模式  

`i`：在当前光标处进行编辑  
`a`：在光标后插入编辑  
`I`：在行首插入  
`A`：在行末插入  

`o`：在当前行后插入一个新行  
`O`：在当前行前插入一个新行  


`r` 取代光标所在的那一个字符一次  
`R` 一直取代光标所在的文字，直到按下 ESC 为止  

`cw`：替换从光标所在位置后到一个单词结尾的字符  



### Command
从普通模式输入:进入命令行模式  



## Exit

普通模式下输入Shift+zz即可保存退出vim  

`:q`：退出  
`:q!`：强制退出，不保存  
`:wq`：保存并退出  
`:wq!`：强制保存并退出  
`:x`：保存并退出  

`:! command` 暂时离开 vi 到指令行模式下执行 command 的显示结果！  

`:w <文件路径>`： 没有指定文件路径就是保存，有路径就是另存为  
`:saveas 文件路径`： 另存为  


`:r [filename]` 在编辑的数据中，读入另一个档案的数据。亦即将 『filename』 这个档案内容加到游标所在行后面  
`:n1,n2 w [filename]` 将 n1 到 n2 的内容储存成 filename 这个档案。  

`ZZ` 如果修改过，保存当前文件，然后退出！效果等同于(保存并退出)  
`ZQ` 不保存，强制退出。效果等同于 :q!。  


## vim 环境的变更
**临时设置环境**
`:set nu`	显示行号，设定之后，会在每一行的前缀显示该行的行号  
`:set nonu`	与 set nu 相反，为取消行号！  

**永久设置环境**
在启动vim时，当前用户根目录下的vimrc文件会被自动读取，因此一般在当前用户的根目录下创建vimrc文件。  

`vim ~/.vimrc`

在打开的vimrc文件中最后一行输入`:set number` ，然后保存退出。  
再次用vim打开文件时，就会显示行号了。  
